<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="/static/js/d3.layout.cloud.js"></script>

<style>
  text:hover {
    fill: black !important;
    font-weight: bold;
  }
</style>

<div id="wordcloud"></div>

<script>
    var wordfreq = {{ wordfreq | safe }}
    var weight = 1.5,
        width = 500,
        height = 300;

    var fill = d3.scale.category20();

    d3.layout.cloud().size([width, height])
            .words(wordfreq)
            .rotate(0)
            .font("Impact")
            .fontSize(function(d) { return weight * d.freq; })
            .on("end", draw)
            .start();

    function draw(words) {
        d3.select("#wordcloud").append("svg")
                .attr("width", width)
                .attr("height", height)
                //.attr("class", "wordcloud")
                .append("g")
                // without the transform, words words would get cutoff to the left and top, they would
                // appear outside of the SVG area
                //.attr("transform", "translate(320,200)")
                .attr("transform", "translate(" + width/2 + "," + height/2 + ")")
                .selectAll("text")
                .data(words)
                .enter().append("text")
                .style("font-size", function(d) { return weight * d.freq + "px"; })
                .style("font-family", "impact")
                .style("fill", function(d, i) { return fill(i); })
                .attr("text-anchor", "middle")
                .attr("transform", function(d) {
                    return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
                })
                .text(function(d) { return d.text; })
                .on({
                  "mouseover": function(d) {
                    d3.select(this).style("font-size", function(d) { return weight * d.freq + 5 + "px" });
                  },
                  "mouseout": function(d) {
                    d3.select(this).style("font-size", function(d) { return weight * d.freq - 5 + "px" });
                  },
                  "click": function(d) {
                    window.open("https://www.google.com/search?q=" + d.text);
                  }
                });
    }
</script>

</html>
