{% load el_pagination_tags %}

{% if brands.all %}
  {% lazy_paginate 40,10 brands.all as all %}
  {% for brand in all %}
    {% include "app/brand_card.html" with brand=brand %}
  {% endfor %}
  {% show_more %}
{% endif %}

{% if brands.recommend %}
  {% lazy_paginate brands.recommend as recommend %}
  {% for brand in recommend %}
    {% include "app/brand_card.html" with brand=brand %}
  {% endfor %}
  {% show_more %}
{% endif %}

{% if brands.not_recommend %}
  <div class="ui horizontal divider header">Not Recommend</div>
  {% lazy_paginate brands.not_recommend as not_recommend %}
  {% for brand in not_recommend %}
    {% include "app/brand_card.html" with brand=brand %}
  {% endfor %}
  {% show_more %}
{% endif %}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="/static/semantic/semantic.min.js"></script>

<script>
  $(window).resize(function(){
    var width = $(".brand.card").width();
    $(".brand.card").css("height", width+"px");
    $(".brand.card img").css({"width":width+"px", "height":width+"px"});
    $(".brand.card .like.icon").css("font-size", width*0.15);
  });

  $(window).trigger('resize');

  function bcard_mouseover(bcard) {
    $(bcard).css({
      "box-shadow": "0 0 10px 5px gainsboro"
    });
  };

  function bcard_mouseout(bcard) {
    $(bcard).css("box-shadow", "0 0 10px 1px gainsboro");
  };

  function bcard_click(bcard) {
    url = $(bcard).attr("href");
    window.location.assign(url); //.replace()로 하면 history가 저장 안된다
    // window.location.replace(url);
  };


  function toggle_like(event, obj) {
    event.stopPropagation();
    icon = $(obj).children(".like.icon");
    state = icon.attr("state");

    if (state=="like") {
      icon.attr("state", "dontlike");
      icon.attr("class", "like outline heart link icon");
      icon.css({"opacity":0.5, "color":"gainsboro"});

    } else {
      icon.attr("state", "like");
      icon.attr("class", "like yellow heart link icon");
      icon.css({"opacity":1, "color":""});
    };

    // $.ajax({
    //   url: {% url 'save_likes' %},
    //   async: true,
    //   type: 'GET',
    //   data: {
    //     like: $(btn).parents(".brand.card").attr("bname")
    //   },
    //   dataType: 'json',
    //   success: function(jqXHR) {
    //     if (!jqXHR.success) {
    //       alert("데이터를 처리하는데 문제가 발생하였습니다.");
    //     };
    //   }
    // });
  };
</script>
