{% extends "app/layout.html" %}

{% block menu_top %}
  {% include "app/menu_top.html" with discover_act="active" %}
{% endblock menu_top %}


{% block content %}
{% load static %}
<link rel="stylesheet" href="https://unpkg.com/tippy.js@4/themes/light.css"/>
<link rel="stylesheet" type="text/css" href="{% static 'quantlab/bcard.css' %}">


<div class="ui text container segments">
   <!-- style="margin-top:70px;"> -->

  <div class="ui padded segment">
    <div class="content" style="background:none;">
      <div class="ui medium header" style="background:none;margin:0;float:left;">
        <i class="compass outline icon"></i>
        <div class="content">
          Discover your fashion style
          <div class="sub header">내 패션 취향 대모험</div>
        </div>
      </div>

      <div class="ui icon tiny basic right floated buttons" style="background:none;margin-top:5px;">
        <button class="ui button" onclick="resize_cards(1)"><i class="minus icon"></i></button>
        <button class="ui button" onclick="resize_cards(-1)"><i class="plus icon"></i></button>
      </div>

      <div style="clear:both;"></div>
    </div>
  </div>


  <div class="ui padded segment">
    <div class="ui header">
      <div class="content">
        <!-- header에 설치된 폰트가 적용되려면, content로 싸아야한다.  -->
        Suggestions for you
      </div>
    </div>

    <div class="content">
      <!-- <div class="ui star rating" data-max-rating="1" style="width:50px;height:50px;font-size:20px;"></div> -->

      <div class="bcards ui four cards">
        {% for brand in suggestions %}
          {% include "app/brand_card.html" with brand=brand %}
        {% endfor %}
      </div>

      <br>
      <a href="{% url 'library' %}">see brand library</a>
    </div>
  </div>

  <div class="ui padded segment">
    <div class="ui header">
      <div class="content">
        Hot trend now
      </div>
    </div>

    <div class="content">
      <div class="bcards ui four cards">
        {% for post in hottrendnow %}
          {% include "app/brand_card.html" with post=post %}
        {% endfor %}
      </div>

      <br>
      <a href="{% url 'posting' %}">posting</a>

      <br>
      <a href="{% url 'posts' %}">see all posts</a>
    </div>
  </div>


  <div class="ui padded segment">
    <div class="ui header">
      <div class="content">
        Social keywords
      </div>
    </div>
    <div class="content">
      <div id="wordcloud" style="text-align:center"></div>
    </div>
  </div>
</div>
{% endblock content %}

{% block js %}
  {{ block.super }}
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="{% static 'js/d3.layout.cloud.js' %}"></script>
  <script src="{% static 'js/wordcloud.js' %}"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/seedrandom/2.4.3/lib/alea.min.js"></script>

  <script src="https://unpkg.com/popper.js@1/dist/umd/popper.min.js"></script>
  <script src="https://unpkg.com/tippy.js@4"></script>

  <script src="{% static 'quantlab/bcard.js' %}"></script>

  <script>
    $(document).ready(function(){
      WordCloud({
        container: "#wordcloud",
        data: {{ socialwords | safe }},
        width: $("#wordcloud").width(),
        height: 600
      });
    });


    var ncols = 4;
    var ncols_max = 6;
    var ncols_min = 1;
    var ncols_matcher = {1:'one', 2:'two', 3:'three', 4:'four', 5:'five', 6:'six'};

    function resize_cards(step) {
      if (step > 0) {
        ncols = Math.min(ncols+step, ncols_max);

      } else if (step < 0) {
        ncols = Math.max(ncols+step, ncols_min);
      }

      $('.bcards').attr('class', "bcards ui cards " + ncols_matcher[ncols]);
      $(window).trigger('resize');
    }

    // $('.ui.rating').rating();
  </script>
{% endblock js %}
