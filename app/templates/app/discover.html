{% extends "app/layout.html" %}

{% block menu_top %}
  {% include "app/menu_top.html" with discover_act="active" %}
{% endblock menu_top %}

{% block content %}
<style>
  .pcard {
    box-shadow: 0 0 10px rgba(0,0,0,0.15) !important;
    cursor: pointer;
    overflow: hidden;
  }

  .pcard:hover {
    box-shadow: 0 0 15px rgba(0,0,0,0.3) !important;
  }
</style>


{% load static %}
<link rel="stylesheet" href="https://unpkg.com/tippy.js@4/themes/light.css"/>
<link rel="stylesheet" type="text/css" href="{% static 'quantlab/bcard.css' %}">

<div class="ui text container segments" style="margin-top:70px;">
  <div class="ui padded segment">
    <div class="ui header">Suggestions for you</div>
    <div class="content">
      <div class="ui four doubling cards">
        {% if suggestions %}
          {% for brand in suggestions %}
            {% include "app/brand_card.html" with brand=brand %}
          {% endfor %}
        {% endif %}
      </div>

      <br>
      <a href="{% url 'library' %}">see brand library</a>
    </div>
  </div>

  <div class="ui padded segment">
    <div class="ui header">Hot trend now</div>
    <div class="content">
      <div class="ui four doubling cards">
        {% if hottrendnow %}
          {% for post in hottrendnow %}
            <div class="pcard card" href="{% url 'post_detail' post.pk %}" onclick="pcard_click(this)">
              <img class="pcard_img" src="{{ post.image.url }}" style="object-fit:cover;margin:auto;">
            </div>
          {% endfor %}
        {% endif %}
      </div>

      <br>
      <a href="{% url 'posting' %}">posting</a>

      <br>
      <a href="{% url 'posts' %}">see all posts</a>
    </div>
  </div>


  <div class="ui padded segment">
    <div class="ui header">Social keywords</div>
    <div class="content">
      <div id="wordcloud" style="text-align:center"></div>
    </div>
  </div>
</div>
{% endblock content %}

{% block js %}
  {{ block.super }}
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="{% static 'js/d3.layout.cloud.js' %}"></script>
  <script src="{% static 'js/wordcloud.js' %}"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/seedrandom/2.4.3/lib/alea.min.js"></script>

  <script src="https://unpkg.com/popper.js@1/dist/umd/popper.min.js"></script>
  <script src="https://unpkg.com/tippy.js@4"></script>

  <script src="{% static 'quantlab/bcard.js' %}"></script>

  <script>
    $(window).resize(function(){
      var width = $(".pcard").width();
      $(".pcard").css("height", width + "px");
      $(".pcard_img").css({"width":width + "px", "height":width + "px"});
    });

    $(window).trigger('resize');

    function pcard_click(pcard) {
      var url = $(pcard).attr("href");
      window.location.assign(url);
    };

    $(document).ready(function(){
      WordCloud({
        container: "#wordcloud",
        data: {{ socialwords | safe }},
        width: $("#wordcloud").width(),
        height: 600
      });
    })

  </script>
{% endblock js %}
