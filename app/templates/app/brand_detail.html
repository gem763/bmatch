{% extends "app/layout.html" %}

{% load static %}
{% block style %}
  {{ block.super }}
  <link rel="stylesheet" href="https://unpkg.com/tippy.js@4/themes/light.css"/>
  <link rel="stylesheet" href="{% static 'quantlab/bcard.css' %}">

  <style>
    .axis {
    	font: 15px sans-serif;
    }

    .axis path,
    .axis line {
      fill: none;
      stroke: #D4D8DA;
      stroke-width: 2px;
      shape-rendering: crispEdges;
    }

    #chart {
    	position: absolute;
    	top: 50px;
    	left: 100px;
    }

    .toolTip {
      pointer-events: none;
    	position: absolute;
        display: none;
      min-width: 50px;
      height: auto;
      background: none repeat scroll 0 0 #ffffff;
      padding: 9px 14px 6px 14px;
      border-radius: 2px;
      text-align: center;
      line-height: 1.3;
      color: #5B6770;
      box-shadow: 0px 3px 9px rgba(0, 0, 0, .15);
    }

    .toolTip:after {
      content: "";
      width: 0;
      height: 0;
      border-left: 12px solid transparent;
      border-right: 12px solid transparent;
      border-top: 12px solid white;
      position: absolute;
      bottom: -10px;
      left: 50%;
      margin-left: -12px;
    }

    .toolTip span {
    	font-weight: 500;
      color: #081F2C;
    }
  </style>
{% endblock style %}

{% block menu_top %}
  {% include "app/menu_top.html" with discover_act="active" %}
{% endblock menu_top %}

{% block content %}
  {% include "app/brand_detail_content.html" %}
{% endblock content %}


{% block js %}
  {{ block.super }}
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <!-- <script src="https://d3js.org/d3-path.v1.min.js" charset="utf-8"></script> -->
  <script src="{% static 'js/d3.layout.cloud.js' %}"></script>
  <script src="{% static 'js/wordcloud.js' %}"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/seedrandom/2.4.3/lib/alea.min.js"></script>

  <script src="https://unpkg.com/popper.js@1/dist/umd/popper.min.js"></script>
  <script src="https://unpkg.com/tippy.js@4"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.bundle.min.js"></script>
  <!-- <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script> -->
  <!-- chartjs 바차트의 rounded bar를 만들어주는 플러그인
  https://github.com/jedtrow/Chart.js-Rounded-Bar-Charts -->
  <script src="{% static 'js/Chart.roundedBarCharts.min.js' %}"></script>
  <script src="{% static 'quantlab/bcard.js' %}"></script>
  <!-- <script src="{% static 'js/d3-components-0.0.5.js' %}"></script> -->
  <!-- <script src="{% static 'js/RadarChart.js' %}"></script> -->
  <script src="{% static 'js/radarChart.js' %}"></script>

  <script>
    function append_table_row(id, query_data){
      var btn = document.createElement('button');
      btn.className = "ui green mini compact right aligned button";
      btn.style.width = (query_data.value*0.9).toString()+"%";
      btn.style.borderRadius = "0 20px 20px 0";
      btn.append(query_data.value);

      var td_query = document.createElement('td');
      td_query.className = "right aligned eight wide";
      // td_query.addClass("right aligned eight wide");
      // td_query.classList.add("right aligned eight wide");
      td_query.append(query_data.key);

      var td_value = document.createElement('td');
      td_value.className = "eight wide";
      td_value.style.padding = "0px";
      td_value.append(btn);

      var tr = document.createElement('tr');
      tr.append(td_query, td_value);
      // return tr;
      $(id).append(tr);
    };


    $(document).ready(function(){
      $.get('{% url "gtrend" brand.name %}', function(data){
        var ctx1 = $("#trend").get(0).getContext("2d");
        new Chart(ctx1, data.trend_data);

        data.query_top_data.forEach(function(query_data){
          append_table_row('#query_top', query_data);
        });

        data.query_rising_data.forEach(function(query_data){
          append_table_row('#query_rising', query_data);
        });
      });

      WordCloud({
        container: "#wordcloud",
        data: {{ simwords | safe }},
        width: $("#wordcloud").width(),
        height: 600
      });
    });


    var data = {
        labels: ['Running', 'Swimming', 'Eating', 'Cycling', 'test', 'test2'],
        datasets: [{
            data: [20, 10, 8, 17, 20, 15]
        }]
    };

    var myRadarChart = new Chart('myChart', {
        type: 'radar',
        data: data//,
        // options: options
    });

    // var margin = { top: 50, right: 80, bottom: 50, left: 80 };
    // var width = window.innerWidth*0.7 - margin.left - margin.right; //Math.min(700, window.innerWidth / 4); // - margin.left - margin.right;
    // var height = window.innerWidth*0.7 - margin.top - margin.bottom;//width; //Math.min(width, window.innerHeight - margin.top - margin.bottom);
    //
    // var data = [
    // 		{ name: 'Allocated budget',
    // 			axes: [
    // 				{axis: 'Sales', value: 42},
    // 				{axis: 'Marketing', value: 20},
    // 				{axis: 'Development', value: 60},
    // 				{axis: 'Customer Support', value: 26},
    // 				{axis: 'Information Technology', value: 35},
    // 				{axis: 'Administration', value: 20}
    // 			]
    // 		},
    // 		{ name: 'Actual Spending',
    // 			axes: [
    // 				{axis: 'Sales', value: 50},
    // 				{axis: 'Marketing', value: 45},
    // 				{axis: 'Development', value: 20},
    // 				{axis: 'Customer Support', value: 20},
    // 				{axis: 'Information Technology', value: 25},
    // 				{axis: 'Administration', value: 23}
    // 			]
    // 		}
    // 	];
    //
    // var options = {
    //   w: width,
    //   h: height,
    //   margin: margin,
    //   maxValue: 60,
    //   levels: 3,
    //   roundStrokes: false,
    //   color: d3.scaleOrdinal().range(["#AFC52F", "#ff6600"]),
    //   format: '.0f',
    //   // legend: { title: 'Organization XYZ', translateX: 100, translateY: 40 },
    //   unit: '$'
  	// };
    //
  	// RadarChart("#chart", data, options);

  </script>
{% endblock js %}
